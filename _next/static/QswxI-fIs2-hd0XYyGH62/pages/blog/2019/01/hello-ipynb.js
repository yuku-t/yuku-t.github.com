(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{NPAK:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/2019/01/hello-ipynb",function(){return a("pmiQ")}])},Yp5c:function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return I}));var n=a("q1tI"),s=a.n(n),o=a("8Kt/"),i=a.n(o),l=a("YFqc"),c=a.n(l),r=a("nOHt"),p=a("TSYQ"),m=a.n(p),u=a("wd/R"),d=a.n(u),h=a("IP2g"),f=a("he5r"),b=s.a.createElement,k=function(e){return b("aside",{className:m()("widget mb-4",e.className)},b("h1",{className:"title font-weight-bold"},e.title),e.children)},N=s.a.createElement,y=function(e){return e||"https://yuku.takahashi.coffee".concat(f.a)},g=Object(r.withRouter)((function(e){return N("div",{className:"blogpage container"},N(i.a,null,N("title",null,e.meta.title," - ",f.c),N("meta",{name:"description",content:e.meta.description}),N("meta",{name:"twitter:card",content:"summary"}),N("meta",{name:"twitter:creator",content:"@yuku_t"}),N("meta",{property:"fb:app_id",content:f.b}),N("meta",{property:"og:title",content:"".concat(e.meta.title," - ").concat(f.c)}),N("meta",{property:"og:type",content:"article"}),N("meta",{property:"og:url",content:"https://yuku.takahashi.coffee".concat(e.router.pathname)}),N("meta",{property:"og:image",content:y()}),N("meta",{property:"og:description",content:e.meta.description}),N("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css"}),N("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css"})),N("div",{className:"row"},N("main",{className:m()("col-xl-8",e.className)},N("article",{itemScope:!0,itemType:"http://schema.org/BlogPosting"},N("meta",{itemProp:"author",content:"Yuku Takahashi"}),N("meta",{itemProp:"datePublished",content:e.meta.publishedAt}),e.meta.modifiedAt&&N("meta",{itemProp:"dateModified",content:e.meta.modifiedAt}),N("meta",{itemProp:"image",content:y()}),N("header",{className:"mb-4 header"},N("h1",{className:"headline",itemProp:"headline"},e.meta.title),N("ul",{className:"list-inline text-dark font-weight-light"},N("li",{className:"list-inline-item"},N("span",{className:"ml-1"},d()(e.meta.publishedAt).format("YYYY-MM-DD HH:mm"))),N("li",{className:"list-inline-item"},e.meta.tags.map((function(e,t){return[t>0?",":null,N("span",{key:t,className:"ml-1"},"#",e)]}))))),N("section",{className:"mb-4 body",itemProp:"articleBody"},e.children))),N("div",{className:"col-xl-4"},N("div",{className:"pl-xl-2"},N(k,{title:"About Me"},N("div",null,N("img",{src:f.a,alt:"avatar",className:"avatar rounded-circle mb-4 mx-auto d-block"}),N("p",null,"Software Engineer at FLYWHEEL. Working mainly on recommendation systems in these days. Ex-Qiita CTO.",N(c.a,{href:"/about"},N("a",{href:"/about",style:{marginLeft:"4px"}},"Read more")),"."))),N(k,{title:"Follow"},N("ul",{className:"list-inline icons"},N("li",{className:"list-inline-item"},N("a",{href:"https://twitter.com/yuku_t"},N("span",{className:"fa-stack fa-lg"},N(h.a,{icon:"circle",className:"fa-stack-2x"}),N(h.a,{icon:["fab","twitter"],inverse:!0,className:"fa-stack-1x"})))),N("li",{className:"list-inline-item"},N("a",{href:"https://github.com/yuku"},N("span",{className:"fa-stack fa-lg"},N(h.a,{icon:"circle",className:"fa-stack-2x"}),N(h.a,{icon:["fab","github"],inverse:!0,className:"fa-stack-1x"})))),N("li",{className:"list-inline-item"},N("a",{href:"/static/rss-feed.xml"},N("span",{className:"fa-stack fa-lg"},N(h.a,{icon:"circle",className:"fa-stack-2x"}),N(h.a,{icon:"rss",inverse:!0,className:"fa-stack-1x"}))))))))))})),w=s.a.createElement,v=function(e){var t=e.meta,a=e.children;return Object(n.useEffect)((function(){if(t.loadTwitterWidget){var e=document.createElement("script");e.async=!0,e.src="https://platform.twitter.com/widgets.js",e.charset="utf-8",document.body.appendChild(e)}}),[]),w(g,{className:"mdx",meta:t},a)},x=s.a.createElement,I=function(e){return x(g,{className:"notebook",meta:e.meta},e.children)}},pmiQ:function(e,t,a){"use strict";a.r(t);var n=a("o0o1"),s=a.n(n),o=a("HaE+"),i=a("q1tI"),l=a.n(i),c=a("Yp5c"),r=l.a.createElement,p=function(){return r("div",{className:"nb-notebook"},r("div",{className:"nb-worksheet"},r("div",{className:"nb-cell nb-markdown-cell"},r("p",null,"Commit: ",r("a",{href:"https://github.com/yuku/yuku.github.io/commit/1c18e263dcc3ca54c0061ccda57b4bca8ba9f9fd"},"yuku/yuku.github.io@",r("code",null,"1c18e26"))),r("p",null,"Jupyter Notebook can now be displayed on this blog. I'm going to use it to publish my study records of machine learning and data analysis. \ud83d\udcaa\ud83c\udffc")),r("div",{className:"nb-cell nb-code-cell"},r("div",{className:"nb-input","data-prompt-number":1},r("pre",{className:"language-python"},r("code",{className:"language-python","data-language":"python"},r("span",{className:"token keyword"},"print"),r("span",{className:"token punctuation"},"("),r("span",{className:"token string"},'"Hello world"'),r("span",{className:"token punctuation"},")")))),r("div",{className:"nb-output","data-prompt-number":1},r("pre",{className:"nb-stdout"},"Hello world","\n"))),r("div",{className:"nb-cell nb-markdown-cell"},r("p",null,"This article describes the details of the implementation."),r("h2",null,"Display ipynb files on Next.js"),r("p",null,"In order to display ipynb files on Next.js, I needed to do two things:"),r("ol",null,r("li",null,"Make a ipynb file readable by Webpack."),r("li",null,"Convert a loaded ipynb file into a React Component.")),r("h3",null,"Make ipynb files readable"),r("p",null,"Next.js uses Webpack for file resolution, so you can use ",r("a",{href:"https://www.npmjs.com/package/ipynb-loader"},"ipynb-loader"),". This loader does nothing more than call ",r("a",{href:"https://github.com/jupyter/nbconvert"},"jupyter/nbconvert")," internally and return the result. jupyter/nbconvter provides the ability to convert ipynb files to HTML, Markdown, etc."),r("p",null,"When using jupyter/nbconvert, I had to decide whether to output as HTML or Markdown"),r("p",null,"If outputting in HTML, I can easily display the characteristic ",r("code",null,"In [1]")," prompt of Jupyter Notebook, but on the other hand, it is difficult to use some desired features such as LaTex notation. ",r("sup",{id:"fnref-1"},r("a",{href:"#fn-1",className:"footnote-ref"},"1"))),r("p",null,"When outputting as Markdown, not only I can use the same processing as MDX, but I can also use Markdown notation that Jupyter Notebook does not support, which is an advantage. On the other hand, the correspondence between input and output is lost, so it doesn't feel like a Jupyter Notebook is displayed."),r("p",null,"After all, when I want to write a blog in ipynb format, I want to express the correspondence between input and output, and if I want to use LaTex, for example, I can write in MDX format, so I decided to output in HTML."),r("h3",null,"Convert to a React Component"),r("p",null,"Next.js expects to import a React Component. This means that Webpack needs to generate a string that can be interpreted as a React Component."),r("p",null,"JSX is useful for writing a React Component. Unfortunately, I couldn't find a Webpack loader that would accomplish this goal, so I implemented such loader by myself using ",r("a",{href:"https://www.npmjs.com/package/htmltojsx"},"htmltojsx"),", which is written by Facebook:"),r("pre",{className:"language-javascript"},r("code",{className:"language-javascript"},r("span",{className:"token keyword"},"const")," ",r("span",{className:"token maybe-class-name"},"HTMLtoJSX")," ",r("span",{className:"token operator"},"=")," ",r("span",{className:"token function"},"require"),r("span",{className:"token punctuation"},"("),r("span",{className:"token string"},'"htmltojsx"'),r("span",{className:"token punctuation"},")"),"\n",r("span",{className:"token keyword"},"const")," converter ",r("span",{className:"token operator"},"=")," ",r("span",{className:"token keyword"},"new")," ",r("span",{className:"token class-name"},"HTMLtoJSX"),r("span",{className:"token punctuation"},"("),r("span",{className:"token punctuation"},"{")," createClass",r("span",{className:"token punctuation"},":")," ",r("span",{className:"token boolean"},"false")," ",r("span",{className:"token punctuation"},"}"),r("span",{className:"token punctuation"},")"),"\n","\n","module",r("span",{className:"token punctuation"},"."),r("span",{className:"token method-variable function-variable method function property-access"},"exports")," ",r("span",{className:"token operator"},"=")," ",r("span",{className:"token keyword"},"function")," ",r("span",{className:"token punctuation"},"("),r("span",{className:"token parameter"},"content"),r("span",{className:"token punctuation"},")")," ",r("span",{className:"token punctuation"},"{"),"\n","  ",r("span",{className:"token comment"},"// The `content` argument is the HTML returned by ipynb-loader."),"\n","  ",r("span",{className:"token keyword"},"return")," ",r("span",{className:"token template-string"},r("span",{className:"token template-punctuation string"},"`"),r("span",{className:"token string"},"\n","  ",'import React from "react"',"\n","  ","export default () => "),r("span",{className:"token interpolation"},r("span",{className:"token interpolation-punctuation punctuation"},"$","{"),"converter",r("span",{className:"token punctuation"},"."),r("span",{className:"token method function property-access"},"convert"),r("span",{className:"token punctuation"},"("),"content",r("span",{className:"token punctuation"},")"),r("span",{className:"token interpolation-punctuation punctuation"},"}")),r("span",{className:"token string"},"\n","  "),r("span",{className:"token template-punctuation string"},"`")),"\n",r("span",{className:"token punctuation"},"}"),"\n")),r("h2",null,"Notes"),r("ul",null,r("li",null,"I've been generated entries.ts file, which is a collection of metadata written in MDX files during compilation, but ipynb doesn't support such metadata, so I gave up on automatically generating the file and decided to manage it manually."),r("li",null,"Using jupyter/nbconvert to generate HTML from ipynb made the Blog's architecture complex, and I had to switch from Travis CI to CircleCI to maintain auto-deployment. Since ipynb is a JSON, it may be good to reimplement it with JavaScript. In that case, it seems that the part that converts Markdown to HTML can be shared with MDX.")),r("h2",null,"Conclusion"),r("p",null,"In my next job, I'm going to use pyspark to analyze data, so I'd like to use this feature to publish the knowledge I've gained while leaning pyspark and using it."),r("p",null,"This is the first time I've written a webpack loader, and it's easier than I thought it would be. Through this implementation, I have learned Webpack itself well. If you feel that you don't know what Webpack is doing, you may be able to understand Webpack better by writing a loader."),r("div",{className:"footnotes"},r("hr",null),r("ol",null,r("li",{id:"fn-1"},"Jupyter Notebook implements LaTex notation using MathJax, but in this blog, I try not to run JS on the browser as much as possible, so I use ",r("a",{href:"https://www.npmjs.com/package/remark-math"},"remark-math")," and ",r("a",{href:"https://www.npmjs.com/package/rehype-katex"},"rehype-katex")," to convert LaTex notation to HTML at compile time.",r("a",{href:"#fnref-1",className:"footnote-backref"},"\u21a9")))))))},m=l.a.createElement,u=function(e){var t=e.meta;return m(c.b,{meta:t},m(p,null))};u.getInitialProps=Object(o.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a("n1xW"),n=t.entries,e.abrupt("return",{meta:n["blog/2019/01/hello-ipynb"]});case 2:case"end":return e.stop()}}),e)})));t.default=u}},[["NPAK",0,1,4,2,3,5]]]);